<script>

    function getFaviconApiUrl(url) {
    if (url) {
      try {
        const urlObject = new URL(url);

        // ignore unresolvable protocols such as file://
        if (urlObject.protocol.startsWith('http')) {
          const domain = urlObject.hostname;
          return `https://www.google.com/s2/favicons?sz=64&domain=${domain}`;
        }
      } catch (e) {}
    }

    return undefined;
  }

    (() => {
      const urlParams = new URLSearchParams(window.location.search);
      const url = urlParams.get('url');

      const faviconApiUrl = getFaviconApiUrl(url);

      if (faviconApiUrl) {
        const res = await fetch(faviconApiUrl);

        if (res.status === 200) {
          window.location.replace(faviconApiUrl)
        }
      }
    })()
</script>
